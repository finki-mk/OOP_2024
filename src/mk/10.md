<img src="../img/logo_mk.png">

# Објектно ориентирано програмирање
## Аудиториска вежба 10 (Исклучоци)

## 1. Производи
Дел од производите во една продавница по новата политика на продавницата мора да имаат одреден попуст. За таа цел во системот на продавницата потребно е да се моделира апстрактната класа Discount. Оваа класа како податок ги има курсевите на евра и долари во денари и методите кои мора секоја класа што ќе наследи од неа да ги имплементира:

    float discount_price();

    float price();

    void print_rule();

За секој производ треба да се чуваат информации за името и цената на производот. Со ова треба да се моделира класата Product. Во неа покрај конструкторите треба да се имплементираат сите потребни методи.

Производите се поделени на неколку типови: FoodProduct, Drinks и Cosmetics.

Според новата политика на продавницата храната нема попуст. Пијалоците и тоа алкохолните поскапи од 20 евра имаат попуст 5%, а неалкохолните од брендот Coca-Cola имаат попуст од 10%. Сите козметички производи поскапи од 5 евра имаат попуст 12%, а оние поскапи од 20 долари имаат попуст 14%.

Да се пресмета вкупната цена на сите производи заедно со попустот.

Исто така да се креира функција changePrice(float) во класата Product која што ќе нуди можност за промена на постоечката цена на производот. Ако се направи обид да се внесе негативна вредност за цената да се фрли исклучок (објект од класата NegativeValueException). Фатете го исклучокот во главната функција каде што ќе ги излистате сите производи од тип Cosmetics и ќе им ја промените цената.



Решение:
```cpp
#include <iostream>
#include <cstring>
using namespace std;

//klasa za iskluchokot
class NegativeValueException{
private:
	char text[50];
public:
	NegativeValueException(char *text)
	{
		strcpy(this->text, text);
	}
	void print() { cout << text; }
};

class Discount {
public:
	static float euro;
	static float dollar;
	virtual float discount_price() = 0;
	virtual float price() = 0;
	virtual void print_rule() = 0;
};

float Discount::euro = 61.7;
float Discount::dollar = 44.5;

class Product {
protected:
	char name[100];
	float price;
public:
	Product(const char *name = "", const float price = 0) {
		strcpy(this->name, name); 
		this->price = price;
	}
	float getPrice() {
		return price;
	}
	void print() {
		cout << "Product{ name=" << name << ", price=" << price << "}" << endl;
	}
	void changePrice(float price){
		if (price < 0) throw NegativeValueException("Vnesena e negativna vrednost za cena!\n");
		this->price = price;
	}
};

class Cosmetics : public Product, public Discount {
private:
	int weight;
public:
	Cosmetics(const char *name = "", const float price = 0,
		const int weight = 0) :Product(name, price){
		this->weight = weight;
	}
	float discount_price() {
		if (getPrice() / Discount::dollar > 20)
			return 0.86 * getPrice();
		if (getPrice() / Discount::euro > 5)
			return 0.88 * getPrice();
		return getPrice();
	}
	float price() {
		return getPrice();
	}
	void print_rule(){
		cout << "Site kozmeticki proizvodi poskapi od 5 evra imaat popust od 12%, dodeka pak onie koi se poskapi od 20 dolari imaat popust 14%" << endl;
	}
};

class FoodProduct : public Product, public Discount{
private:
	float callories;
public:
	FoodProduct(const char *name = "", const float price = 0,
		const float callories = 0) : Product(name, price) {
		this->callories = callories;
	}

	float discount_price() {
		return getPrice();
	}

	float price() {
		return getPrice();
	}

	void print_rule(){
		cout << "Nema popust za proizvodite od tip na hrana" << endl;
	}
};

class Drinks : public Product, public Discount {
private:
	char brand[100];
	bool alcoholic;
public:
	Drinks(const char *name = "", const float price = 0,
		const char *brand = "", const bool alcoholic = false) : Product(name, price) {
		strcpy(this->brand, brand);
		this->alcoholic = alcoholic;
	}
	float discount_price() {
		if (this->alcoholic && (getPrice() / Discount::euro > 20))
			return 0.95 * getPrice();
		if (!this->alcoholic && (strcmp(this->brand, "Coca-Cola") == 0))
			return 0.90 * getPrice();
		return getPrice();
	}
	float price() { return getPrice(); }
	void print_rule(){
		cout << "Site alkoholni pijaloci poskapi od 20 evra imaat popust od 5 % , dodeka pak nealkoholnite od brendot Coca - Cola imaat popust od 10 % "<<endl;
	}
};

float total_discount(Discount **d, int n) {
	float discount = 0;
	for (int i = 0; i < n; ++i) {
		discount += d[i]->discount_price();
		cout << "Prvicna cena: " << d[i]->price() << endl;
		cout << "So popust: " << d[i]->discount_price() << endl;
		d[i]->print_rule();
	}
	return discount;
}

int main() {
	int n = 0;
	float newPrice;
	Discount **d = new Discount*[10];
		d[n++] = new FoodProduct("leb", 30);
		d[n++] = new Drinks("viski", 1350, "Jack Daniel's", true);
		d[n++] = new FoodProduct("sirenje", 390, 105);
		d[n++] = new Drinks("votka", 850, "Finlandia", true);
		d[n++] = new Cosmetics("krema", 720, 100);
		d[n++] = new Drinks("sok", 50, "Coca-Cola", false);
		d[n++] = new Cosmetics("parfem", 3500, 50);

	cout << "Vkupnata cena na site proizvodi e: " << total_discount(d, n) << endl;
	
	//se menuva cenata na site Kozmeticki proizvodi
	cout << "Promena na cenata na kozmetickite proizvodi " << endl;
	for (int i = 0; i < n; ++i) {
		Cosmetics* c = dynamic_cast<Cosmetics *>(d[i]);
		if (c != 0){
			c->print();
			cin >> newPrice;
			try{
				c->changePrice(newPrice);
			}
			catch (NegativeValueException i){
				i.print();
			}
		}
	}

	for (int i = 0; i < n; ++i) {
		delete d[i];
	}
	delete[] d;

	return 0;
}
```
Излез:
```text
Prvicna cena: 30
So popust: 30
Nema popust za proizvodite od tip na hrana
Prvicna cena: 1350
So popust: 1282.5
Site alkoholni pijaloci poskapi od 20 evra imaat popust od 5 % , dodeka pak neal
koholnite od brendot Coca - Cola imaat popust od 10 %
Prvicna cena: 390
So popust: 390
Nema popust za proizvodite od tip na hrana
Prvicna cena: 850
So popust: 850
Site alkoholni pijaloci poskapi od 20 evra imaat popust od 5 % , dodeka pak neal
koholnite od brendot Coca - Cola imaat popust od 10 %
Prvicna cena: 720
So popust: 633.6
Site kozmeticki proizvodi poskapi od 5 evra imaat popust od 12%, dodeka pak onie
 koi se poskapi od 20 dolari imaat popust 14%
Prvicna cena: 50
So popust: 45
Site alkoholni pijaloci poskapi od 20 evra imaat popust od 5 % , dodeka pak neal
koholnite od brendot Coca - Cola imaat popust od 10 %
Prvicna cena: 3500
So popust: 3010
Site kozmeticki proizvodi poskapi od 5 evra imaat popust od 12%, dodeka pak onie
 koi se poskapi od 20 dolari imaat popust 14%
Vkupnata cena na site proizvodi e: 6241.1
Promena na cenata na kozmetickite proizvodi
Product{ name=krema, price=720}
750
Product{ name=parfem, price=3500}
-3600
Vnesena e negativna vrednost za cena!
```

## 2. Продукти со попуст
Да се имплементира класа Product за која се чуваат името и цената. Да се имплементира апстрактна класа Discount во која има два чисто виртуелни методи за цена и за цена со попуст. Од овие класи да се изведат класите:

FoodProduct за која дополнително се чува бројот на калории;

DigitalProduct за која дополнително се чува големината (во MB)

Да се имплементира надворешна функција total_discount која ќе пресметува вкупен попуст на неколку продукти на попуст кои ги прима како аргумент.

Решение:
```cpp
#include <iostream>
#include <cstring>
using namespace std;
class Discount {
public:
        virtual float getDiscount_price() = 0;
        virtual float getPrice() = 0;
};
class Product {
protected:
        string name;
        float price;
public:
        Product(string name = "", const float price = 0) {
                this -> name = name;
                this->price = price;
        }
        float getPrice() {
                return price;
        }
};

class DigitalProduct : public Product, public Discount {
private:
        float size;
public:
        DigitalProduct(string name = "", const float price = 0, const float size = 0): Product(name, price){
                this->size = size;
        }
        // се препокриваат функциите од апстрактната класа
        float getDiscount_price() {
                // попустот е 10%
                return 0.9 * getPrice();
        }
        // и двете класи Product и Discount имаат функција getPrice, која се
        // препокрива во изведената. Оваа ја користи getPrice од Product
        float getPrice() {
                return Product::getPrice();
        }

};

class FoodProduct : public Product, public Discount {
private:
        float callories;
public:
        FoodProduct(const char *name = "", const float price = 0, const float callories = 0) : Product(name, price) {
                this->callories = callories;
        }
        float getDiscount_price() {
                // попустот е 20%
                return .8 * getPrice();
        }
        // и двете класи Product и Discount имаат функција getPrice, која се
        // препокрива во изведената. Оваа ја користи getPrice од Product
        float getPrice() {
                return Product::getPrice();
        }
};

float total_discount(Discount **d, int n) {
        float price = 0;
        for (int i = 0; i < n; ++i) {
                // повик на функцијата getPrice од класата FoodProduct или
                // DigitalProduct соодветно, затоа што во Discount функцијата е виртуелна
                price += d[i]->getPrice();
        }
        float discount = 0;
        for (int i = 0; i < n; ++i) {
                discount += d[i]->getDiscount_price();
        }
        return price - discount;
}
int main() {
        Discount **d = new Discount*[3];
        d[0] = new FoodProduct("Cheese", 450, 1200);
        d[1] = new FoodProduct("Wine", 780, 250);
        d[2] = new DigitalProduct("WOW", 380, 400);
        cout << "Difference: " << total_discount(d, 3) << endl;
        for (int i = 0; i < 3; ++i) {
                delete d[i];
        }
        delete[] d;
        return 0;
}
```
